<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Glass Planner</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
*{box-sizing:border-box;margin:0;padding:0;font-family:-apple-system,BlinkMacSystemFont,sans-serif;}

body{
    background:linear-gradient(135deg,#0f2027,#2c5364,#1c1c1c);
    display:flex;
    justify-content:center;
    align-items:center;
    min-height:100vh;
    color:white;
}

/* Layout */
.app{
    display:flex;
    width:95%;
    max-width:1300px;
    height:90vh;
    gap:20px;
}

/* Glass Effect */
.glass{
    backdrop-filter:blur(20px);
    background:rgba(255,255,255,0.08);
    border-radius:20px;
    border:1px solid rgba(255,255,255,0.15);
    box-shadow:0 8px 32px rgba(0,0,0,0.4);
    padding:20px;
}

/* Calendar */
.calendar{
    flex:1;
}

.header{
    display:flex;
    justify-content:space-between;
    align-items:center;
    margin-bottom:20px;
}

.header button{
    background:none;border:none;color:white;font-size:22px;cursor:pointer;
}

.days,.dates{
    display:grid;
    grid-template-columns:repeat(7,1fr);
    text-align:center;
}

.days div{opacity:0.6;margin-bottom:10px;}

.dates div{
    padding:12px;
    border-radius:50%;
    cursor:pointer;
    position:relative;
}

.dates div:hover{background:rgba(255,255,255,0.1);}

.selected{
    background:rgba(255,255,255,0.25);
}

.dot{
    width:6px;
    height:6px;
    background:#4cd964;
    border-radius:50%;
    position:absolute;
    bottom:5px;
    left:50%;
    transform:translateX(-50%);
}

/* Task Panel */
.tasks{
    flex:1;
    display:flex;
    flex-direction:column;
    overflow-y:auto;
}

textarea,input[type="time"]{
    width:100%;
    padding:10px;
    margin-top:10px;
    border-radius:10px;
    border:none;
    background:rgba(255,255,255,0.1);
    color:white;
}

button.save{
    margin-top:10px;
    padding:10px;
    border:none;
    border-radius:12px;
    background:linear-gradient(45deg,#4cd964,#5ac8fa);
    cursor:pointer;
    font-weight:bold;
}

ul{list-style:none;margin-top:15px;}

li{
    padding:12px;
    margin-bottom:12px;
    border-radius:15px;
    background:rgba(255,255,255,0.08);
}

.completed{opacity:0.5;text-decoration:line-through;}

.meta{font-size:12px;opacity:0.6;margin-top:5px;}

.actions button{
    margin-top:5px;
    margin-right:5px;
    background:none;
    border:none;
    cursor:pointer;
    color:#5ac8fa;
}

/* Responsive */
@media(max-width:900px){
    .app{flex-direction:column;height:auto;}
}
</style>
</head>

<body>

<div class="app">

<div class="calendar glass">
<div class="header">
<button onclick="changeMonth(-1)">‚Äπ</button>
<h2 id="monthYear"></h2>
<button onclick="changeMonth(1)">‚Ä∫</button>
</div>

<div class="days">
<div>Sun</div><div>Mon</div><div>Tue</div>
<div>Wed</div><div>Thu</div><div>Fri</div><div>Sat</div>
</div>

<div class="dates" id="dates"></div>
</div>

<div class="tasks glass">
<h3 id="selectedDate">Select a date</h3>

<textarea id="taskInput" placeholder="Write your task... üòä"></textarea>
<input type="time" id="taskTime">
<button class="save" onclick="saveTask()">Save Task</button>

<ul id="taskList"></ul>
</div>

</div>

<script>

/* Notification Permission */
if("Notification" in window){
    Notification.requestPermission();
}

let now=new Date();
let currentMonth=now.getMonth();
let currentYear=now.getFullYear();
let selectedKey="";

function renderCalendar(){
    const dates=document.getElementById("dates");
    dates.innerHTML="";
    document.getElementById("monthYear").innerText=
    new Date(currentYear,currentMonth)
    .toLocaleString("default",{month:"long"})+" "+currentYear;

    let firstDay=new Date(currentYear,currentMonth,1).getDay();
    let lastDate=new Date(currentYear,currentMonth+1,0).getDate();

    for(let i=0;i<firstDay;i++) dates.innerHTML+="<div></div>";

    for(let d=1;d<=lastDate;d++){
        let div=document.createElement("div");
        div.innerText=d;
        div.onclick=()=>selectDate(d);

        let key=currentYear+"-"+currentMonth+"-"+d;
        let tasks=JSON.parse(localStorage.getItem(key))||[];
        if(tasks.length>0){
            let dot=document.createElement("div");
            dot.className="dot";
            div.appendChild(dot);
        }

        dates.appendChild(div);
    }
}

function changeMonth(step){
    currentMonth+=step;
    if(currentMonth<0){currentMonth=11;currentYear--;}
    if(currentMonth>11){currentMonth=0;currentYear++;}
    renderCalendar();
}

function selectDate(d){
    selectedKey=currentYear+"-"+currentMonth+"-"+d;
    document.getElementById("selectedDate").innerText=
    d+" "+
    new Date(currentYear,currentMonth)
    .toLocaleString("default",{month:"long"})+" "+currentYear;
    loadTasks();
}

function saveTask(){
    if(!selectedKey)return;

    let text=document.getElementById("taskInput").value;
    let time=document.getElementById("taskTime").value;
    if(!text)return;

    let tasks=JSON.parse(localStorage.getItem(selectedKey))||[];

    tasks.push({
        text:text,
        time:time,
        created:new Date().toLocaleString(),
        completed:null,
        done:false
    });

    localStorage.setItem(selectedKey,JSON.stringify(tasks));
    document.getElementById("taskInput").value="";
    loadTasks();
    renderCalendar();
}

function loadTasks(){
    let list=document.getElementById("taskList");
    list.innerHTML="";
    let tasks=JSON.parse(localStorage.getItem(selectedKey))||[];

    tasks.forEach((task,i)=>{
        let li=document.createElement("li");
        if(task.done) li.classList.add("completed");

        li.innerHTML=`
        <div contenteditable="true" onblur="editTask(${i},this.innerText)">
        ${task.text}
        </div>
        <div>‚è∞ ${task.time||"No time"}</div>
        <div class="meta">
        Created: ${task.created}<br>
        Completed: ${task.completed||"-"}
        </div>
        <div class="actions">
            <button onclick="toggleDone(${i})">‚úì</button>
            <button onclick="deleteTask(${i})">üóë</button>
        </div>
        `;

        list.appendChild(li);
    });
}

function editTask(i,newText){
    let tasks=JSON.parse(localStorage.getItem(selectedKey));
    tasks[i].text=newText;
    localStorage.setItem(selectedKey,JSON.stringify(tasks));
}

function toggleDone(i){
    let tasks=JSON.parse(localStorage.getItem(selectedKey));
    tasks[i].done=!tasks[i].done;
    tasks[i].completed=tasks[i].done?new Date().toLocaleString():null;
    localStorage.setItem(selectedKey,JSON.stringify(tasks));
    loadTasks();
}

function deleteTask(i){
    let tasks=JSON.parse(localStorage.getItem(selectedKey));
    tasks.splice(i,1);
    localStorage.setItem(selectedKey,JSON.stringify(tasks));
    loadTasks();
    renderCalendar();
}

/* Reminder Check */
setInterval(()=>{
    let now=new Date();
    let key=now.getFullYear()+"-"+now.getMonth()+"-"+now.getDate();
    let tasks=JSON.parse(localStorage.getItem(key))||[];

    tasks.forEach(task=>{
        if(task.time && !task.done){
            let [h,m]=task.time.split(":");
            if(now.getHours()==h && now.getMinutes()==m && now.getSeconds()==0){
                if(Notification.permission==="granted"){
                    new Notification("Reminder üîî",{body:task.text});
                }
            }
        }
    });
},1000);

renderCalendar();

</script>

</body>
</html>